从网上拷的代码，自己做了些修改的,实际上不是我写的;
